// Copyright (c) 2025 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-bigint-support@v0.2.2-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.2.1-esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-accessor@v0.2.2-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-bytes-per-element@v0.2.2-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-iteration-order@v0.2.2-esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-strides2order@v0.2.2-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-slice@v0.2.2-esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/boolean-ctor@v0.2.2-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-minmax-view-buffer-index@v0.2.2-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-column-major-string@esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-float64-real@v0.1.1-esm/index.mjs";import _ from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-float64-imag@v0.1.1-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/string-replace@v0.2.2-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-little-endian@v0.2.2-esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/array-buffer@v0.2.2-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/array-dataview@v0.2.2-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/bigint-ctor@v0.2.2-esm/index.mjs";import{enum as g}from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-dtypes@v0.3.0-esm/index.mjs";import{enum as b}from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-orders@v0.2.2-esm/index.mjs";import{enum as y}from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-index-modes@v0.2.2-esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/array-uint8@v0.2.2-esm/index.mjs";import{assign as v}from"https://cdn.jsdelivr.net/gh/stdlib-js/number-float64-base-to-int64-bytes@v0.2.2-esm/index.mjs";function O(t,s){return s&&(2===t||3===t)}function x(t,s){return s&&(1===t||3===t)}var I={int8:"new Int8Array( [ {{data}} ] )",uint8:"new Uint8Array( [ {{data}} ] )",uint8c:"new Uint8ClampedArray( [ {{data}} ] )",int16:"new Int16Array( [ {{data}} ] )",uint16:"new Uint16Array( [ {{data}} ] )",int32:"new Int32Array( [ {{data}} ] )",uint32:"new Uint32Array( [ {{data}} ] )",float32:"new Float32Array( [ {{data}} ] )",float64:"new Float64Array( [ {{data}} ] )",generic:"[ {{data}} ]",binary:"new Buffer( [ {{data}} ] )",complex64:"new Complex64Array( [ {{data}} ] )",complex128:"new Complex128Array( [ {{data}} ] )",bool:"new BooleanArray( [ {{data}} ] )"};var w=g(),A=b(),U=y();var E=g(),N=b(),R=y();function L(t,s,e,h,a,d){var _,m,l,p,u;if(!(this instanceof L))return new L(t,s,e,h,a,d);for(p=1,u=0;u<e.length;u++)p*=e[u];return m=s.BYTES_PER_ELEMENT?s.BYTES_PER_ELEMENT*p:null,this._byteLength=m,this._bytesPerElement=i(t),this._buffer=s,this._dtype=t,this._length=p,this._ndims=e.length,this._offset=a,this._order=d,this._shape=e,this._strides=h,this._accessors=o(s.get&&s.set),this._iterationOrder=r(h),_=function(t,s,e,i,r){var n;return 0!==t&&0!==r&&t===(n=f(s,e,i))[1]-n[0]+1}(p,e,h,a,this._iterationOrder),l=n(h),this._flags={ROW_MAJOR_CONTIGUOUS:x(l,_),COLUMN_MAJOR_CONTIGUOUS:O(l,_),READONLY:!1},this.__meta_dataview__=null,this}s(L,"name","ndarray"),e(L.prototype,"byteLength",(function(){return this._byteLength})),e(L.prototype,"BYTES_PER_ELEMENT",(function(){return this._bytesPerElement})),e(L.prototype,"data",(function(){return this._buffer})),e(L.prototype,"dtype",(function(){return this._dtype})),e(L.prototype,"flags",(function(){return{ROW_MAJOR_CONTIGUOUS:(t=this._flags).ROW_MAJOR_CONTIGUOUS,COLUMN_MAJOR_CONTIGUOUS:t.COLUMN_MAJOR_CONTIGUOUS,READONLY:t.READONLY};var t})),e(L.prototype,"length",(function(){return this._length})),e(L.prototype,"ndims",(function(){return this._ndims})),e(L.prototype,"offset",(function(){return this._offset})),e(L.prototype,"order",(function(){return this._order})),e(L.prototype,"shape",(function(){return h(this._shape,0,this._shape.length)})),e(L.prototype,"strides",(function(){return h(this._strides,0,this._strides.length)})),s(L.prototype,"get",(function(){var t,s;for(t=this._offset,s=0;s<arguments.length;s++)t+=this._strides[s]*arguments[s];return this._accessors?this._buffer.get(t):this._buffer[t]})),s(L.prototype,"iget",(function(t){var s,e,i,r,n,h;if(0===(i=this._ndims))return this._accessors?this._buffer.get(this._offset):this._buffer[this._offset];if(this._flags.ROW_MAJOR_CONTIGUOUS||this._flags.COLUMN_MAJOR_CONTIGUOUS){if(1===this._iterationOrder)return this._accessors?this._buffer.get(this._offset+t):this._buffer[this._offset+t];if(-1===this._iterationOrder)return this._accessors?this._buffer.get(this.offset-t):this._buffer[this._offset-t]}if(e=this._shape,s=this._strides,r=this._offset,a(this._order)){for(h=0;h<i;h++)t-=n=t%e[h],t/=e[h],r+=n*s[h];return this._accessors?this._buffer.get(r):this._buffer[r]}for(h=i-1;h>=0;h--)t-=n=t%e[h],t/=e[h],r+=n*s[h];return this._accessors?this._buffer.get(r):this._buffer[r]})),s(L.prototype,"set",(function(){var t,s;for(t=this._offset,s=0;s<arguments.length-1;s++)t+=this._strides[s]*arguments[s];return this._accessors?this._buffer.set(arguments[s],t):this._buffer[t]=arguments[s],this})),s(L.prototype,"iset",(function(t,s){var e,i,r,n,h,o;if(0===(r=this._ndims))return this._accessors?this._buffer.set(t,this._offset):this._buffer[this._offset]=t,this;if(this._flags.ROW_MAJOR_CONTIGUOUS||this._flags.COLUMN_MAJOR_CONTIGUOUS){if(1===this._iterationOrder)return this._accessors?this._buffer.set(s,this._offset+t):this._buffer[this._offset+t]=s,this;if(-1===this._iterationOrder)return this._accessors?this._buffer.set(s,this._offset-t):this._buffer[this._offset-t]=s,this}if(i=this._shape,e=this._strides,n=this._offset,a(this._order)){for(o=0;o<r;o++)t-=h=t%i[o],t/=i[o],n+=h*e[o];return this._accessors?this._buffer.set(s,n):this._buffer[n]=s,this}for(o=r-1;o>=0;o--)t-=h=t%i[o],t/=i[o],n+=h*e[o];return this._accessors?this._buffer.set(s,n):this._buffer[n]=s,this})),s(L.prototype,"toString",(function(){var t,s,e,i,r,n,h;if(s=this._shape.length,i="ndarray( '"+(r=this._dtype)+"', ",t="",this._length<=100)if("complex64"===r||"complex128"===r)for(h=0;h<this._length;h++)n=this.iget(h),t+=d(n)+", "+_(n),h<this._length-1&&(t+=", ");else for(h=0;h<this._length;h++)t+=this.iget(h),h<this._length-1&&(t+=", ");else{if("complex64"===r||"complex128"===r)for(h=0;h<3;h++)n=this.iget(h),t+=d(n)+", "+_(n),h<2&&(t+=", ");else for(h=0;h<3;h++)t+=this.iget(h),h<2&&(t+=", ");if(t+=", ..., ","complex64"===r||"complex128"===r)for(h=2;h>=0;h--)n=this.iget(this._length-1-h),t+=d(n)+", "+_(n),h>0&&(t+=", ");else for(h=2;h>=0;h--)t+=this.iget(this._length-1-h),h>0&&(t+=", ")}if(e=I[this.dtype],i+=m(e,"{{data}}",t),i+=", ",i+=0===s?"[]":"[ "+this._shape.join(", ")+" ]",i+=", ",i+="[ ",0===s)i+="0";else for(h=0;h<s;h++)this._strides[h]<0?i+=-this._strides[h]:i+=this._strides[h],h<s-1&&(i+=", ");return i+=" ]",i+=", ",i+="0",i+=", ",i+="'"+this._order+"'",i+=" )"})),s(L.prototype,"toJSON",(function(){var t,s,e,i;for(s=this._length,(t={}).type="ndarray",t.dtype=this.dtype,t.flags={READONLY:this._flags.READONLY},t.order=this._order,t.shape=this._shape.slice(),t.strides=this._strides.slice(),i=0;i<t.strides.length;i++)t.strides[i]<0&&(t.strides[i]*=-1);if(t.data=[],"complex64"===t.dtype||"complex128"===t.dtype)for(i=0;i<s;i++)e=this.iget(i),t.data.push(d(e),_(e));else for(i=0;i<s;i++)t.data.push(this.iget(i));return t})),s(L.prototype,"__array_meta_dataview__",t()?function(){var t,s,e,i,r,n,h,o,f,a,d,_,m,g;if(f=this._mode||"throw",h=this._submode||[f],e=33+16*(_=this._ndims)+(m=h.length),(o=this.__meta_dataview__)&&o.byteLength===e)return o;for(o=new u(new p(e)),r=this._shape,n=this._strides,i=this._dtype,t=this._bytesPerElement,a=0,o.setInt8(a,l?1:0),a+=1,o.setInt16(a,w[i],l),a+=2,o.setBigInt64(a,c(_),l),d=8*_,a+=8,g=0;g<_;g++)o.setBigInt64(a,c(r[g]),l),o.setBigInt64(a+d,c(n[g]*t),l),a+=8;for(a+=d,o.setBigInt64(a,c(this._offset*t),l),a+=8,o.setInt8(a,A[this._order]),a+=1,o.setInt8(a,U[f]),a+=1,o.setBigInt64(a,c(m),l),a+=8,g=0;g<m;g++)o.setInt8(a,U[h[g]]),a+=1;return s=0,s|=this._flags.READONLY?4:0,o.setInt32(a,s,l),this.__meta_dataview__=o,o}:function(){var t,s,e,i,r,n,h,o,f,a,d,_,m,c,g;if(a=this._mode||"throw",o=this._submode||[a],i=33+16*(m=this._ndims)+(c=o.length),(f=this.__meta_dataview__)&&f.byteLength===i)return f;for(f=new u(new p(i)),s=new j(f.buffer),n=this._shape,h=this._strides,r=this._dtype,t=this._bytesPerElement,d=0,f.setInt8(d,l?1:0),d+=1,f.setInt16(d,E[r],l),v(m,s,1,d+=2),_=8*m,d+=8,g=0;g<m;g++)v(n[g],s,1,d),v(h[g]*t,s,1,d+_),d+=8;for(d+=_,v(this._offset*t,s,1,d),d+=8,f.setInt8(d,N[this._order]),d+=1,f.setInt8(d,R[a]),v(c,s,1,d+=1),d+=8,g=0;g<c;g++)f.setInt8(d,R[o[g]]),d+=1;return e=0,e|=this._flags.READONLY?4:0,f.setInt32(d,e,l),this.__meta_dataview__=f,f});export{L as default};
//# sourceMappingURL=index.mjs.map
