// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-bigint-support@esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-accessor@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-bytes-per-element@esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-iteration-order@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-strides2order@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-minmax-view-buffer-index@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-real@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-imag@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/string-replace@esm/index.mjs";import _ from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-little-endian@esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/array-buffer@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/array-dataview@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/bigint-ctor@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-dtypes@esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-orders@esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-index-modes@esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/array-uint8@esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/number-float64-base-to-int64-bytes@esm/index.mjs";var y=function(t,s){return s&&(2===t||3===t)};var j=function(t,s){return s&&(1===t||3===t)},O=h;var v=function(t,s,e,i,r){var n;return 0!==t&&0!==r&&t===(n=O(s,e,i))[1]-n[0]+1};var x=function(t){return{ROW_MAJOR_CONTIGUOUS:t.ROW_MAJOR_CONTIGUOUS,COLUMN_MAJOR_CONTIGUOUS:t.COLUMN_MAJOR_CONTIGUOUS,READONLY:t.READONLY}};var I=function(t){var s,e,i,r,n,h;if(0===(i=this._ndims))return this._accessors?this._buffer.get(this._offset):this._buffer[this._offset];if(this._flags.ROW_MAJOR_CONTIGUOUS||this._flags.COLUMN_MAJOR_CONTIGUOUS){if(1===this._iterationOrder)return this._accessors?this._buffer.get(this._offset+t):this._buffer[this._offset+t];if(-1===this._iterationOrder)return this._accessors?this._buffer.get(this.offset-t):this._buffer[this._offset-t]}if(e=this._shape,s=this._strides,r=this._offset,"column-major"===this._order){for(h=0;h<i;h++)t-=n=t%e[h],t/=e[h],r+=n*s[h];return this._accessors?this._buffer.get(r):this._buffer[r]}for(h=i-1;h>=0;h--)t-=n=t%e[h],t/=e[h],r+=n*s[h];return this._accessors?this._buffer.get(r):this._buffer[r]};var U=function(t,s){var e,i,r,n,h,o;if(0===(r=this._ndims))return this._accessors?this._buffer.set(t,this._offset):this._buffer[this._offset]=t,this;if(this._flags.ROW_MAJOR_CONTIGUOUS||this._flags.COLUMN_MAJOR_CONTIGUOUS){if(1===this._iterationOrder)return this._accessors?this._buffer.set(s,this._offset+t):this._buffer[this._offset+t]=s,this;if(-1===this._iterationOrder)return this._accessors?this._buffer.set(s,this._offset-t):this._buffer[this._offset-t]=s,this}if(i=this._shape,e=this._strides,n=this._offset,"column-major"===this._order){for(o=0;o<r;o++)t-=h=t%i[o],t/=i[o],n+=h*e[o];return this._accessors?this._buffer.set(s,n):this._buffer[n]=s,this}for(o=r-1;o>=0;o--)t-=h=t%i[o],t/=i[o],n+=h*e[o];return this._accessors?this._buffer.set(s,n):this._buffer[n]=s,this};var w=function(){var t,s;for(t=this._offset,s=0;s<arguments.length-1;s++)t+=this._strides[s]*arguments[s];return this._accessors?this._buffer.set(arguments[s],t):this._buffer[t]=arguments[s],this};var A=function(){var t,s;for(t=this._offset,s=0;s<arguments.length;s++)t+=this._strides[s]*arguments[s];return this._accessors?this._buffer.get(t):this._buffer[t]},E=o,N=f;var R=function(){var t,s,e,i;for(s=this._length,(t={}).type="ndarray",t.dtype=this.dtype,t.flags={READONLY:this._flags.READONLY},t.order=this._order,t.shape=this._shape.slice(),t.strides=this._strides.slice(),i=0;i<s;i++)t.strides[i]<0&&(t.strides[i]*=-1);if(t.data=[],"complex64"===t.dtype||"complex128"===t.dtype)for(i=0;i<s;i++)e=this.iget(i),t.data.push(E(e),N(e));else for(i=0;i<s;i++)t.data.push(this.iget(i));return t},L=a,C=o,M=f,T={int8:"new Int8Array( [ {{data}} ] )",uint8:"new Uint8Array( [ {{data}} ] )",uint8c:"new Uint8ClampedArray( [ {{data}} ] )",int16:"new Int16Array( [ {{data}} ] )",uint16:"new Uint16Array( [ {{data}} ] )",int32:"new Int32Array( [ {{data}} ] )",uint32:"new Uint32Array( [ {{data}} ] )",float32:"new Float32Array( [ {{data}} ] )",float64:"new Float64Array( [ {{data}} ] )",generic:"[ {{data}} ]",binary:"new Buffer( [ {{data}} ] )",complex64:"new Complex64Array( [ {{data}} ] )",complex128:"new Complex128Array( [ {{data}} ] )"};var S=function(){var t,s,e,i,r,n,h;if(s=this._shape.length,i="ndarray( '"+(r=this._dtype)+"', ",t="",this._length<=100)if("complex64"===r||"complex128"===r)for(h=0;h<this._length;h++)n=this.iget(h),t+=C(n)+", "+M(n),h<this._length-1&&(t+=", ");else for(h=0;h<this._length;h++)t+=this.iget(h),h<this._length-1&&(t+=", ");else{if("complex64"===r||"complex128"===r)for(h=0;h<3;h++)n=this.iget(h),t+=C(n)+", "+M(n),h<2&&(t+=", ");else for(h=0;h<3;h++)t+=this.iget(h),h<2&&(t+=", ");if(t+=", ..., ","complex64"===r||"complex128"===r)for(h=2;h>=0;h--)n=this.iget(this._length-1-h),t+=C(n)+", "+M(n),h>0&&(t+=", ");else for(h=2;h>=0;h--)t+=this.iget(this._length-1-h),h>0&&(t+=", ")}if(e=T[this.dtype],i+=L(e,"{{data}}",t),i+=", ",i+=0===s?"[]":"[ "+this._shape.join(", ")+" ]",i+=", ",i+="[ ",0===s)i+="0";else for(h=0;h<s;h++)this._strides[h]<0?i+=-this._strides[h]:i+=this._strides[h],h<s-1&&(i+=", ");return i+=" ]",i+=", ",i+="0",i+=", ",i+="'"+this._order+"'",i+=" )"},J=_,B=d,G=m,Y=p,D=l.enum,P=u.enum,W=c.enum,F=D(),k=P(),q=W();var z=function(){var t,s,e,i,r,n,h,o,f,a,_,d,m,p;if(f=this._mode||"throw",h=this._submode||[f],e=33+16*(d=this._ndims)+(m=h.length),(o=this.__meta_dataview__)&&o.byteLength===e)return o;for(o=new G(new B(e)),r=this._shape,n=this._strides,i=this._dtype,t=this._bytesPerElement,a=0,o.setInt8(a,J?1:0),a+=1,o.setInt16(a,F[i],J),a+=2,o.setBigInt64(a,Y(d),J),_=8*d,a+=8,p=0;p<d;p++)o.setBigInt64(a,Y(r[p]),J),o.setBigInt64(a+_,Y(n[p]*t),J),a+=8;for(a+=_,o.setBigInt64(a,Y(this._offset*t),J),a+=8,o.setInt8(a,k[this._order]),a+=1,o.setInt8(a,q[f]),a+=1,o.setBigInt64(a,Y(m),J),a+=8,p=0;p<m;p++)o.setInt8(a,q[h[p]]),a+=1;return s=0,s|=this._flags.READONLY?4:0,o.setInt32(a,s,J),this.__meta_dataview__=o,o},H=_,K=d,Q=m,V=g,X=l.enum,Z=u.enum,$=c.enum,tt=b.assign,st=X(),et=Z(),it=$();var rt=t,nt=s,ht=e,ot=i,ft=r,at=n,_t=y,dt=j,mt=v,pt=x,lt=I,ut=U,ct=w,gt=A,bt=R,yt=S,jt=z,Ot=function(){var t,s,e,i,r,n,h,o,f,a,_,d,m,p,l;if(a=this._mode||"throw",o=this._submode||[a],i=33+16*(m=this._ndims)+(p=o.length),(f=this.__meta_dataview__)&&f.byteLength===i)return f;for(f=new Q(new K(i)),s=new V(f.buffer),n=this._shape,h=this._strides,r=this._dtype,t=this._bytesPerElement,_=0,f.setInt8(_,H?1:0),_+=1,f.setInt16(_,st[r],H),tt(m,s,1,_+=2),d=8*m,_+=8,l=0;l<m;l++)tt(n[l],s,1,_),tt(h[l]*t,s,1,_+d),_+=8;for(_+=d,tt(this._offset*t,s,1,_),_+=8,f.setInt8(_,et[this._order]),_+=1,f.setInt8(_,it[a]),tt(p,s,1,_+=1),_+=8,l=0;l<p;l++)f.setInt8(_,it[o[l]]),_+=1;return e=0,e|=this._flags.READONLY?4:0,f.setInt32(_,e,H),this.__meta_dataview__=f,f};function vt(t,s,e,i,r,n){var h,o,f,a,_;if(!(this instanceof vt))return new vt(t,s,e,i,r,n);for(a=1,_=0;_<e.length;_++)a*=e[_];return o=s.BYTES_PER_ELEMENT?s.BYTES_PER_ELEMENT*a:null,this._byteLength=o,this._bytesPerElement=ot(t),this._buffer=s,this._dtype=t,this._length=a,this._ndims=e.length,this._offset=r,this._order=n,this._shape=e,this._strides=i,this._accessors=Boolean(s.get&&s.set),this._iterationOrder=ft(i),h=mt(a,e,i,r,this._iterationOrder),f=at(i),this._flags={ROW_MAJOR_CONTIGUOUS:dt(f,h),COLUMN_MAJOR_CONTIGUOUS:_t(f,h),READONLY:!1},this.__meta_dataview__=null,this}nt(vt,"name","ndarray"),ht(vt.prototype,"byteLength",(function(){return this._byteLength})),ht(vt.prototype,"BYTES_PER_ELEMENT",(function(){return this._bytesPerElement})),ht(vt.prototype,"data",(function(){return this._buffer})),ht(vt.prototype,"dtype",(function(){return this._dtype})),ht(vt.prototype,"flags",(function(){return pt(this._flags)})),ht(vt.prototype,"length",(function(){return this._length})),ht(vt.prototype,"ndims",(function(){return this._ndims})),ht(vt.prototype,"offset",(function(){return this._offset})),ht(vt.prototype,"order",(function(){return this._order})),ht(vt.prototype,"shape",(function(){return this._shape.slice()})),ht(vt.prototype,"strides",(function(){return this._strides.slice()})),nt(vt.prototype,"get",gt),nt(vt.prototype,"iget",lt),nt(vt.prototype,"set",ct),nt(vt.prototype,"iset",ut),nt(vt.prototype,"toString",yt),nt(vt.prototype,"toJSON",bt),nt(vt.prototype,"__array_meta_dataview__",rt()?jt:Ot);var xt=vt;export{xt as default};
//# sourceMappingURL=index.mjs.map
